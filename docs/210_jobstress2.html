<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>직업환경의학연구방법론 - 2&nbsp; job stress questionnaires</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./210_jobstress1.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

<script src="site_libs/htmlwidgets-1.6.2/htmlwidgets.js"></script>
<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">
<script src="site_libs/datatables-binding-0.27/datatables.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.min.css" rel="stylesheet">
<link href="site_libs/dt-core-1.12.1/css/jquery.dataTables.extra.css" rel="stylesheet">
<script src="site_libs/dt-core-1.12.1/js/jquery.dataTables.min.js"></script>
<link href="site_libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet">
<script src="site_libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
<script src="site_libs/kePrint-0.0.1/kePrint.js"></script>
<link href="site_libs/lightable-0.0.1/lightable.css" rel="stylesheet">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="table {
  font-family: 'Times New Roman', serif;
}">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./210_jobstress1.html">I. 직무스트레스</a></li><li class="breadcrumb-item"><a href="./210_jobstress2.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">job stress questionnaires</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">직업환경의학연구방법론</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">직업병 연구방법론 개론</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">I. 직무스트레스</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./210_jobstress1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">직무스트레스란</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./210_jobstress2.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">job stress questionnaires</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#설문지-개발" id="toc-설문지-개발" class="nav-link active" data-scroll-target="#설문지-개발"><span class="header-section-number">2.1</span> 설문지 개발</a>
  <ul class="collapse">
  <li><a href="#기본-r-준비" id="toc-기본-r-준비" class="nav-link" data-scroll-target="#기본-r-준비"><span class="header-section-number">2.1.1</span> 기본 R 준비</a></li>
  <li><a href="#basic-data-step" id="toc-basic-data-step" class="nav-link" data-scroll-target="#basic-data-step"><span class="header-section-number">2.1.2</span> basic data step</a></li>
  <li><a href="#설문지와-데이터-비교하기" id="toc-설문지와-데이터-비교하기" class="nav-link" data-scroll-target="#설문지와-데이터-비교하기"><span class="header-section-number">2.1.3</span> 설문지와 데이터 비교하기</a></li>
  <li><a href="#변수에-라벨링-붙이기" id="toc-변수에-라벨링-붙이기" class="nav-link" data-scroll-target="#변수에-라벨링-붙이기"><span class="header-section-number">2.1.4</span> 변수에 라벨링 붙이기</a></li>
  <li><a href="#결측값-제거" id="toc-결측값-제거" class="nav-link" data-scroll-target="#결측값-제거"><span class="header-section-number">2.1.5</span> 결측값 제거</a></li>
  </ul></li>
  <li><a href="#주성분분석" id="toc-주성분분석" class="nav-link" data-scroll-target="#주성분분석"><span class="header-section-number">2.2</span> 주성분분석</a>
  <ul class="collapse">
  <li><a href="#주성분분석-간단-소개" id="toc-주성분분석-간단-소개" class="nav-link" data-scroll-target="#주성분분석-간단-소개"><span class="header-section-number">2.2.1</span> 주성분분석 간단 소개</a></li>
  <li><a href="#요인이-몇개면-좋을까" id="toc-요인이-몇개면-좋을까" class="nav-link" data-scroll-target="#요인이-몇개면-좋을까"><span class="header-section-number">2.2.2</span> 요인이 몇개면 좋을까?</a></li>
  <li><a href="#요인-고정-분석" id="toc-요인-고정-분석" class="nav-link" data-scroll-target="#요인-고정-분석"><span class="header-section-number">2.2.3</span> 요인 고정 분석</a></li>
  </ul></li>
  <li><a href="#요인-개수-정하기-신뢰도-측면" id="toc-요인-개수-정하기-신뢰도-측면" class="nav-link" data-scroll-target="#요인-개수-정하기-신뢰도-측면"><span class="header-section-number">2.3</span> 요인 개수 정하기: 신뢰도 측면</a>
  <ul class="collapse">
  <li><a href="#신뢰도-값-cronbach-alpha" id="toc-신뢰도-값-cronbach-alpha" class="nav-link" data-scroll-target="#신뢰도-값-cronbach-alpha"><span class="header-section-number">2.3.1</span> 신뢰도 값 (Cronbach alpha)</a></li>
  </ul></li>
  <li><a href="#요인값-활용하기" id="toc-요인값-활용하기" class="nav-link" data-scroll-target="#요인값-활용하기"><span class="header-section-number">2.4</span> 요인값 활용하기</a>
  <ul class="collapse">
  <li><a href="#요인값-데이터화" id="toc-요인값-데이터화" class="nav-link" data-scroll-target="#요인값-데이터화"><span class="header-section-number">2.4.1</span> 요인값 데이터화</a></li>
  <li><a href="#우울증-점수-phq-9" id="toc-우울증-점수-phq-9" class="nav-link" data-scroll-target="#우울증-점수-phq-9"><span class="header-section-number">2.4.2</span> 우울증 점수 (PHQ-9)</a></li>
  <li><a href="#요인별-사용-방법" id="toc-요인별-사용-방법" class="nav-link" data-scroll-target="#요인별-사용-방법"><span class="header-section-number">2.4.3</span> 요인별 사용 방법</a></li>
  <li><a href="#과제-소진-증후군과-감정노동" id="toc-과제-소진-증후군과-감정노동" class="nav-link" data-scroll-target="#과제-소진-증후군과-감정노동"><span class="header-section-number">2.4.4</span> 과제: 소진 증후군과 감정노동</a></li>
  </ul></li>
  <li><a href="#mediation" id="toc-mediation" class="nav-link" data-scroll-target="#mediation"><span class="header-section-number">2.5</span> Indirect effect</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="jobstress" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">job stress questionnaires</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>&nbsp; 본 강의에서는 <code>2014년 장세진 등</code>이 연구한 한국형 감정노동 설문지의 연구 계발 중 감정노동 설문지 하부 구조 구성에 대한 내용입니다. 감정근로자를 대상으로한 질적 면담을 통해 총 26개 질적 항목이 도출되었고, 이를 조사 문항으로 변경하였고, 2014년 약 2000명의 고객 응대 근로자를 조사하였다. 이 중 변수를 축소할 수 있으지, 불필요한 변수가 있는지, 변수 사이에 일정한 특성이 있어 하부 구조를 만들수 있는지 여부를 판단하는 것이 실습 목표입니다.</p>
<section id="설문지-개발" class="level2" data-number="2.1">
<h2 data-number="2.1" class="anchored" data-anchor-id="설문지-개발"><span class="header-section-number">2.1</span> 설문지 개발</h2>
<section id="기본-r-준비" class="level3" data-number="2.1.1">
<h3 data-number="2.1.1" class="anchored" data-anchor-id="기본-r-준비"><span class="header-section-number">2.1.1</span> 기본 R 준비</h3>
<p><code>tidyverse</code> 를 통해 대부분의 data step 과정을 수행할 것이며, <code>라벨</code> 작업을 위해 <code>labelled</code> package를 이용할 것이다. spss 파일을 불러오기위해 <code>haven</code> package 사용할 것이다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"tidyverse"</span>)) <span class="fu">install.packages</span>(<span class="st">"tidyverse"</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"labelled"</span>)) <span class="fu">install.packages</span>(<span class="st">"labelled"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(<span class="st">"haven"</span>)) <span class="fu">install.packages</span>(<span class="st">"haven"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="basic-data-step" class="level3" data-number="2.1.2">
<h3 data-number="2.1.2" class="anchored" data-anchor-id="basic-data-step"><span class="header-section-number">2.1.2</span> basic data step</h3>
<p>spss 파일인 <code>data_n2221.sav</code>를 불러 dat에 저장한다. 이후 처음부터 100번째 줄만 사용한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>dat<span class="ot">&lt;-</span><span class="fu">read_sav</span>(<span class="st">"data/jobstress/data_n2221.sav"</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>dat <span class="ot">&lt;-</span>dat[, <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span> ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">look_for</span>(dat, <span class="at">details =</span> <span class="cn">FALSE</span>) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-b62fcfb737b8a7411df0" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-b62fcfb737b8a7411df0">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],["no_1","no_2","gender","age","education","marriage","job","job_code","job_code5","day_hour","year","month","type","shift","working_hour","holiday","holiday_hour","a1","a2","a3","a4","a5","a6","a7","a8","a9","a10","a11","a12","a13","a14","a15","a16","a17","a18","a19","a20","a21","a22","a23","a24","a25","a26","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","c1","c2","c3","c4","c5","c6","c7","c8","c9","c10","c11","c12","c13","c14","d1","d2","d3","d4","d5","d6","d7","d8","d9","e1","e2","e3","e4","e5","f1","f2","f3","g1","g1_day","g1_1","g2","g2_day","g2_1","g3","g3_day","g4","g5","g6","g6_1","age_group","workhour","new_month","new_year"],["no_1","no_2","성","연령","최종학력","결혼상태","현재직무","직업군14코드","직업군5코드","하루평균고객응대시간","근무년수","month","고용형태","교대근무","주간평균근무시간","휴일근무","한달평균휴일근무시간","a1","a2","a3","a4","a5","a6","a7","a8","a9","a10","a11","a12","a13","a14","a15","a16","a17","a18","a19","a20","a21","a22","a23","a24","a25","a26","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","c1","c2","c3","c4","c5","c6","c7","c8","c9","c10","c11","c12","c13","c14","PHQ1","PHQ2","PHQ3","PHQ4","PHQ5","PHQ6","PHQ7","PHQ8","PHQ9","BURNOUT1","BURNOUT2","BURNOUT3","BURNOUT4","BURNOUT5","QOL1","QOL2","QOL3","g1","g1_day","g1_1","g2","g2_day","g2_1","g3","g3_day","g4","g5","g6","g6_1","연령집단","주간근로시간",null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>pos<\/th>\n      <th>variable<\/th>\n      <th>label<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":1},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="설문지와-데이터-비교하기" class="level3" data-number="2.1.3">
<h3 data-number="2.1.3" class="anchored" data-anchor-id="설문지와-데이터-비교하기"><span class="header-section-number">2.1.3</span> 설문지와 데이터 비교하기</h3>
<p>설문지를 찾아보면 아래와 같이 감정노동 설문지가 있다. a1부터 a26까지 라밸을 붙여 기억하기 쉽게 하자.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/que.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">감정노동설문지</figcaption>
</figure>
</div>
</section>
<section id="변수에-라벨링-붙이기" class="level3" data-number="2.1.4">
<h3 data-number="2.1.4" class="anchored" data-anchor-id="변수에-라벨링-붙이기"><span class="header-section-number">2.1.4</span> 변수에 라벨링 붙이기</h3>
<p>a1 ~ a6 까지의 변수에 <code>emotional labor Q</code>를 1부터 26까지 라벨로 저장해보자. 참고로 레이블은 변수에 list 처럼 정보가 저장되어 변수별 list를 만들고 즉, <code>an[1]</code>에 <code>emotional labor Q1</code>을 저장하고 반복하면 된다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>an <span class="ot">&lt;-</span> <span class="fu">list</span>()</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>) {an[i] <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">'emotional labor Q'</span>, i, <span class="at">sep=</span><span class="st">""</span>)}</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(an) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">'a'</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">26</span>, <span class="at">sep=</span><span class="st">""</span>)</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="fu">var_label</span>(dat) <span class="ot">&lt;-</span> an</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="fu">look_for</span>(dat) <span class="sc">%&gt;%</span> DT<span class="sc">::</span><span class="fu">datatable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">

<div class="datatables html-widget html-fill-item-overflow-hidden html-fill-item" id="htmlwidget-0a3a7397bf0eb4ad3029" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-0a3a7397bf0eb4ad3029">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100],["no_1","no_2","gender","age","education","marriage","job","job_code","job_code5","day_hour","year","month","type","shift","working_hour","holiday","holiday_hour","a1","a2","a3","a4","a5","a6","a7","a8","a9","a10","a11","a12","a13","a14","a15","a16","a17","a18","a19","a20","a21","a22","a23","a24","a25","a26","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","c1","c2","c3","c4","c5","c6","c7","c8","c9","c10","c11","c12","c13","c14","d1","d2","d3","d4","d5","d6","d7","d8","d9","e1","e2","e3","e4","e5","f1","f2","f3","g1","g1_day","g1_1","g2","g2_day","g2_1","g3","g3_day","g4","g5","g6","g6_1","age_group","workhour","new_month","new_year"],["no_1","no_2","성","연령","최종학력","결혼상태","현재직무","직업군14코드","직업군5코드","하루평균고객응대시간","근무년수","month","고용형태","교대근무","주간평균근무시간","휴일근무","한달평균휴일근무시간","emotional labor Q1","emotional labor Q2","emotional labor Q3","emotional labor Q4","emotional labor Q5","emotional labor Q6","emotional labor Q7","emotional labor Q8","emotional labor Q9","emotional labor Q10","emotional labor Q11","emotional labor Q12","emotional labor Q13","emotional labor Q14","emotional labor Q15","emotional labor Q16","emotional labor Q17","emotional labor Q18","emotional labor Q19","emotional labor Q20","emotional labor Q21","emotional labor Q22","emotional labor Q23","emotional labor Q24","emotional labor Q25","emotional labor Q26","b1","b2","b3","b4","b5","b6","b7","b8","b9","b10","c1","c2","c3","c4","c5","c6","c7","c8","c9","c10","c11","c12","c13","c14","PHQ1","PHQ2","PHQ3","PHQ4","PHQ5","PHQ6","PHQ7","PHQ8","PHQ9","BURNOUT1","BURNOUT2","BURNOUT3","BURNOUT4","BURNOUT5","QOL1","QOL2","QOL3","g1","g1_day","g1_1","g2","g2_day","g2_1","g3","g3_day","g4","g5","g6","g6_1","연령집단","주간근로시간",null,null],["dbl","dbl","dbl+lbl","dbl","dbl","dbl+lbl","chr","dbl+lbl","dbl+lbl","dbl","dbl","dbl","dbl+lbl","dbl+lbl","dbl","dbl+lbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl","dbl+lbl","dbl","dbl","dbl+lbl","dbl","dbl","dbl+lbl","dbl","dbl+lbl","dbl","dbl+lbl","dbl","dbl+lbl","dbl+lbl","dbl","dbl"],[0,0,6,179,37,9,0,101,101,69,82,82,50,29,108,67,1040,16,24,30,33,24,27,25,25,31,27,16,21,22,22,24,38,42,29,26,32,28,23,21,20,27,21,26,24,24,31,30,36,30,31,26,30,49,62,52,63,59,61,68,63,58,70,64,72,71,70,28,30,30,31,40,30,31,28,32,23,23,27,25,31,74,74,74,46,2052,2004,55,1889,1799,44,1537,63,37,37,2064,179,108,82,82],[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],[null,null,[1,2],null,null,[1,2,3,4],null,[1,2,3,4,5,6,8,9,10,11,12,13,14],[1,2,3,4,5],null,null,null,[1,2,3,4,5],[1,2],null,[1,2],null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,[1,2],null,null,[1,2],null,null,[1,2],null,[1,2],null,[1,2],null,[1,2,3,4],[1,2,3,4],null,null]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>pos<\/th>\n      <th>variable<\/th>\n      <th>label<\/th>\n      <th>col_type<\/th>\n      <th>missing<\/th>\n      <th>levels<\/th>\n      <th>value_labels<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"className":"dt-right","targets":[1,5]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>b1… c1.. .변수는 고객 폭력 설문지이다. 따라서 이번 실습에서는 사용하지 않도록 하겠다. 시작이 <code>b</code> 또는 <code>c</code>로 시작되고 뒤에 숫자가 붙어 있는 변수는 모두 제거하려고 한다. (<code>^</code>는 맨 앞이란 뜻, <code>\\d</code>는 )</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>dat2 <span class="ot">&lt;-</span> dat <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">grep</span>(<span class="st">'^b|c</span><span class="sc">\\</span><span class="st">d'</span>, <span class="fu">names</span>(dat)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="결측값-제거" class="level3" data-number="2.1.5">
<h3 data-number="2.1.5" class="anchored" data-anchor-id="결측값-제거"><span class="header-section-number">2.1.5</span> 결측값 제거</h3>
<p>감정노동 설문지에서 <b>결측값이 있는 경우 실습에서 제외</b> 하도록 하자. 이제 분석을 위해 gg 라는 파일을 만들자 시작이 <code>a</code>이고 뒤에 숫자가 붙어 있는 변수는 감정노동 변수이다. 이때 <code>NA</code>가 포함되어 있는 것은 모두 지우고자 한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>gg<span class="ot">&lt;-</span>dat2 <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>(<span class="fu">grep</span>(<span class="st">'^a</span><span class="sc">\\</span><span class="st">d'</span>, <span class="fu">names</span>(dat2))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="주성분분석" class="level2" data-number="2.2">
<h2 data-number="2.2" class="anchored" data-anchor-id="주성분분석"><span class="header-section-number">2.2</span> 주성분분석</h2>
<section id="주성분분석-간단-소개" class="level3" data-number="2.2.1">
<h3 data-number="2.2.1" class="anchored" data-anchor-id="주성분분석-간단-소개"><span class="header-section-number">2.2.1</span> 주성분분석 간단 소개</h3>
<p>주성분분석을 간단히 설명하면, 잠재적으로 적은 수의 관찰되지 않은 변수의 관점에서 관찰 된 상관 변수 간의 변동성을 설명하고자 하는 방법이다. 이때 <code>잠재적으로 적은 수의 관찰되지 않은 변수</code>가 요인(<code>factor</code>)가 된다-<code>wikipedia</code>. 즉 현재 26개의 감정노동 변수가 몇개의 요인으로 설명될수 있는지를 물어보자. 만약 2개의 요인 감정의 피로, 조직의 보호 같은 요인이 숨어 있다고 해보자. 그리고 2개의 요인이 전체 데이터를 한 70% 설명해 준다고 하자. 그러면 2개의 요인의 요약값으로 데이터를 해석하고 분석하는 것도 매우 효율적인 방법 중 하나일 것이다. 이렇게 되면 어떠한 설문문항은 감정의 피로는 높고 조직의 보호는 낮은 것으로 이해되고, 어떠한 설문문항은 감정의 피로도 높고 조직의 보호도 높은 것일 수 있다. 즉 <span class="math inline">\(X_1, X_2 . . .X_N\)</span>의 변수는 요인(<span class="math inline">\(F_k\)</span>)(unobservable latent factors)로 인해 설명될 수 있다. 즉, <span class="math display">\[ X_1 = w_{1,0} + w_{1,1}F_1 ...w_{1,k}F_k + e_1 \\
   X_2 = w_{2,0} + w_{2,1}F_1 ...w_{2,k}F_k + e_2 \\
   ..... \\
   X_N = w_{N,0} + w_{N,1}F_1 ...w_{N,k}F_k + e_N \\
\]</span> 여기서 <span class="math inline">\(k\)</span>가 얼마일지에 대한 대답을 하는 과정 이기도 하다.</p>
</section>
<section id="요인이-몇개면-좋을까" class="level3" data-number="2.2.2">
<h3 data-number="2.2.2" class="anchored" data-anchor-id="요인이-몇개면-좋을까"><span class="header-section-number">2.2.2</span> 요인이 몇개면 좋을까?</h3>
<p>설문지 항목을 읽어보고 몇개로 나누면 좋을지 생각해보자. 아까의 설문지 파일을 다시 보자.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 8%">
<col style="width: 91%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">variable</th>
<th style="text-align: left;">Questionnaire</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: left;">1. 고객에게 부정적인 감정을 표현하지 않으려고 의식적으로 노력한다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a2</td>
<td style="text-align: left;">2. 고객을 대할 때 회사의 요구대로 감정 표현을 할 수밖에 없다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a3</td>
<td style="text-align: left;">3. 업무상 고객을 대하는 과정에서 나의 솔직한 감정을 숨긴다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a4</td>
<td style="text-align: left;">4. 일상적인 업무수행을 위해서는 감정을 조절하려는 노력이 필요하다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a5</td>
<td style="text-align: left;">5. 고객을 대할 때 느끼는 나의 감정과 내가 실제 표현하는 감정은 다르다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a6</td>
<td style="text-align: left;">6. 공격적이거나 까다로운 고객을 상대해야 한다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a7</td>
<td style="text-align: left;">7. 나의 능력이나 권한 밖의 일을 요구하는 고객을 상대해야 한다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a8</td>
<td style="text-align: left;">8. 고객의 부당하거나 막무가내의 요구로 업무 수행의 어려움이 있다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a9</td>
<td style="text-align: left;">9. 직장은 나의 상황보다는 고객의 입장만을 고려하도록 강요한다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a10</td>
<td style="text-align: left;">10. 고객을 응대할 때 자존심이 상한다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a11</td>
<td style="text-align: left;">11. 고객에게 감정을 숨기고 표현하지 못할 때 나는 감정이 상한다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a12</td>
<td style="text-align: left;">12. 고객을 응대할 때 나의 감정이 상품처럼 느껴진다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a13</td>
<td style="text-align: left;">13. 퇴근 후에도 고객을 응대할 때 힘들었던 감정이 남아 있다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a14</td>
<td style="text-align: left;">14. 고객을 대하는 과정에서 마음의 상처를 받는다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a15</td>
<td style="text-align: left;">15. 몸이 피곤해도 고객들에게 최선을 다해야 하므로 감정적으로 힘들다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a16</td>
<td style="text-align: left;">16. 직장이 요구하는 대로 고객에게 잘 응대하는지 감시를 당한다(CC TV 등).</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a17</td>
<td style="text-align: left;">17. 고객의 평가가 업무성과평가나 인사고과에 영향을 준다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a18</td>
<td style="text-align: left;">18. 고객 응대에 문제가 발생했을 때, 나의 잘못이 아닌데도 직장으로부터 부당한 처우를 받는다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a19</td>
<td style="text-align: left;">19. 직원들을 보호하기 위하여 고객들의 부당한 행위를 직장에서 모니터링(관찰, 녹음, 확인 등) 하고 있다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a20</td>
<td style="text-align: left;">20. 고객 응대 과정에서 문제가 발생 시 직장에서 적절한 조치가 이루어진다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a21</td>
<td style="text-align: left;">21. 고객 응대 과정에서 발생한 문제를 해결하고 도와주는 직장 내의 공식적인 제도와 절차가 있다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a22</td>
<td style="text-align: left;">22. 직장은 고객 응대 과정에서 입은 마음의 상처를 위로받게 해준다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a23</td>
<td style="text-align: left;">23. 상사는 고객 응대 과정에서 발생한 문제를 해결하기 위해 도와준다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a24</td>
<td style="text-align: left;">24. 동료는 고객 응대 과정에서 발생한 문제를 해결하기 위해 도와준다.</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a25</td>
<td style="text-align: left;">25. 직장 내에 고객 응대에 관한 행동지침이나 매뉴얼(설명서, 안내서)이 마련되어 있다.</td>
</tr>
<tr class="even">
<td style="text-align: left;">a26</td>
<td style="text-align: left;">26. 고객의 요구를 해결해 줄 수 있는 권한이나 자율성이 나에게 주어져 있다.</td>
</tr>
</tbody>
</table>
</div>
</div>
<p>PCA (principal Components Anaysis)를 실행해 보자. 우선 분석 데이터의 이름을 <code>gg</code>로 바꾸었고, 이중 PCA를 돌릴 감정노동 변수만을 <code>em</code>으로 선정하자.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>em <span class="ot">&lt;-</span>gg <span class="sc">%&gt;%</span> <span class="fu">select</span>(<span class="fu">grep</span>(<span class="st">'^a</span><span class="sc">\\</span><span class="st">d'</span>, <span class="fu">names</span>(gg)))</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span><span class="fu">princomp</span>(em, <span class="at">cor=</span><span class="cn">TRUE</span>)</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                          Comp.1    Comp.2     Comp.3     Comp.4    Comp.5
Standard deviation     2.9109785 1.8140133 1.29145144 1.14149754 0.9981856
Proportion of Variance 0.3259152 0.1265632 0.06414796 0.05011602 0.0383221
Cumulative Proportion  0.3259152 0.4524785 0.51662643 0.56674246 0.6050646
                           Comp.6     Comp.7     Comp.8     Comp.9    Comp.10
Standard deviation     0.94878939 0.88188337 0.85890832 0.82933490 0.80598461
Proportion of Variance 0.03462313 0.02991224 0.02837398 0.02645371 0.02498505
Cumulative Proportion  0.63968768 0.66959992 0.69797390 0.72442761 0.74941266
                          Comp.11    Comp.12    Comp.13    Comp.14    Comp.15
Standard deviation     0.76934437 0.75306547 0.71665409 0.70291372 0.70214574
Proportion of Variance 0.02276503 0.02181183 0.01975358 0.01900337 0.01896187
Cumulative Proportion  0.77217769 0.79398952 0.81374310 0.83274647 0.85170834
                          Comp.16    Comp.17    Comp.18    Comp.19    Comp.20
Standard deviation     0.67203301 0.65055854 0.64059641 0.62269499 0.61420308
Proportion of Variance 0.01737032 0.01627794 0.01578322 0.01491343 0.01450944
Cumulative Proportion  0.86907866 0.88535660 0.90113982 0.91605325 0.93056269
                         Comp.21    Comp.22    Comp.23    Comp.24     Comp.25
Standard deviation     0.5965547 0.58295100 0.56112051 0.55494148 0.501662398
Proportion of Variance 0.0136876 0.01307046 0.01210985 0.01184462 0.009679429
Cumulative Proportion  0.9442503 0.95732074 0.96943059 0.98127521 0.990954641
                           Comp.26
Standard deviation     0.484952908
Proportion of Variance 0.009045359
Cumulative Proportion  1.000000000</code></pre>
</div>
</div>
<p>그림을 그려보자</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(fit, <span class="at">type=</span><span class="st">"lines"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">1</span>, <span class="at">col=</span><span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="210_jobstress2_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="library-nfactors-이용하기" class="level4" data-number="2.2.2.1">
<h4 data-number="2.2.2.1" class="anchored" data-anchor-id="library-nfactors-이용하기"><span class="header-section-number">2.2.2.1</span> library nFactors 이용하기</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nFactors)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>ev <span class="ot">&lt;-</span> <span class="fu">eigen</span>(<span class="fu">cor</span>(em)) <span class="co"># get eigenvalues</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>ap <span class="ot">&lt;-</span> <span class="fu">parallel</span>(<span class="at">subject=</span><span class="fu">nrow</span>(em),<span class="at">var=</span><span class="fu">ncol</span>(em),<span class="at">rep=</span><span class="dv">100</span>,<span class="at">cent=</span>.<span class="dv">05</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>nS <span class="ot">&lt;-</span> <span class="fu">nScree</span>(<span class="at">x=</span>ev<span class="sc">$</span>values, <span class="at">aparallel=</span>ap<span class="sc">$</span>eigen<span class="sc">$</span>qevpea)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plotnScree</span>(nS)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="210_jobstress2_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>요인의 개수를 4개 또는 5개로 추천해 주고 있다. 여튼 4개 이상의 요인 구성해보고 시작해보자.</p>
</section>
</section>
<section id="요인-고정-분석" class="level3" data-number="2.2.3">
<h3 data-number="2.2.3" class="anchored" data-anchor-id="요인-고정-분석"><span class="header-section-number">2.2.3</span> 요인 고정 분석</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>fit <span class="ot">&lt;-</span> <span class="fu">principal</span>(em, <span class="at">nfactors=</span><span class="dv">4</span>, <span class="at">rotate=</span><span class="st">"varimax"</span>)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(fit, digits = 3, sort = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>로딩값 0.4이상인 것을 하나의 동일한 요인으로 구분해보고, 우리의 생각과 비슷한지 관찰해 보자.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<colgroup>
<col style="width: 2%">
<col style="width: 76%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
<col style="width: 5%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Q</th>
<th style="text-align: left;">ques</th>
<th style="text-align: right;">RC1</th>
<th style="text-align: right;">RC2</th>
<th style="text-align: right;">RC3</th>
<th style="text-align: right;">RC4</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">a14</td>
<td style="text-align: left;">14. 고객을 대하는 과정에서 마음의 상처를 받는다.</td>
<td style="text-align: right;">0.823</td>
<td style="text-align: right;">-0.067</td>
<td style="text-align: right;">0.107</td>
<td style="text-align: right;">0.129</td>
</tr>
<tr class="even">
<td style="text-align: left;">a13</td>
<td style="text-align: left;">13. 퇴근 후에도 고객을 응대할 때 힘들었던 감정이 남아 있다.</td>
<td style="text-align: right;">0.785</td>
<td style="text-align: right;">-0.074</td>
<td style="text-align: right;">0.078</td>
<td style="text-align: right;">0.109</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a11</td>
<td style="text-align: left;">11. 고객에게 감정을 숨기고 표현하지 못할 때 나는 감정이 상한다.</td>
<td style="text-align: right;">0.756</td>
<td style="text-align: right;">-0.077</td>
<td style="text-align: right;">0.175</td>
<td style="text-align: right;">0.134</td>
</tr>
<tr class="even">
<td style="text-align: left;">a10</td>
<td style="text-align: left;">10. 고객을 응대할 때 자존심이 상한다.</td>
<td style="text-align: right;">0.754</td>
<td style="text-align: right;">-0.146</td>
<td style="text-align: right;">0.166</td>
<td style="text-align: right;">0.190</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a12</td>
<td style="text-align: left;">12. 고객을 응대할 때 나의 감정이 상품처럼 느껴진다.</td>
<td style="text-align: right;">0.741</td>
<td style="text-align: right;">-0.110</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">0.195</td>
</tr>
<tr class="even">
<td style="text-align: left;">a15</td>
<td style="text-align: left;">15. 몸이 피곤해도 고객들에게 최선을 다해야 하므로 감정적으로 힘들다.</td>
<td style="text-align: right;">0.726</td>
<td style="text-align: right;">-0.064</td>
<td style="text-align: right;">0.242</td>
<td style="text-align: right;">0.162</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a8</td>
<td style="text-align: left;">8. 고객의 부당하거나 막무가내의 요구로 업무 수행의 어려움이 있다.</td>
<td style="text-align: right;">0.680</td>
<td style="text-align: right;">-0.083</td>
<td style="text-align: right;">0.335</td>
<td style="text-align: right;">0.161</td>
</tr>
<tr class="even">
<td style="text-align: left;">a7</td>
<td style="text-align: left;">7. 나의 능력이나 권한 밖의 일을 요구하는 고객을 상대해야 한다.</td>
<td style="text-align: right;">0.634</td>
<td style="text-align: right;">-0.086</td>
<td style="text-align: right;">0.366</td>
<td style="text-align: right;">0.102</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a6</td>
<td style="text-align: left;">6. 공격적이거나 까다로운 고객을 상대해야 한다.</td>
<td style="text-align: right;">0.598</td>
<td style="text-align: right;">-0.025</td>
<td style="text-align: right;">0.426</td>
<td style="text-align: right;">0.054</td>
</tr>
<tr class="even">
<td style="text-align: left;">a9</td>
<td style="text-align: left;">9. 직장은 나의 상황보다는 고객의 입장만을 고려하도록 강요한다.</td>
<td style="text-align: right;">0.544</td>
<td style="text-align: right;">-0.201</td>
<td style="text-align: right;">0.304</td>
<td style="text-align: right;">0.321</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a23</td>
<td style="text-align: left;">23. 상사는 고객 응대 과정에서 발생한 문제를 해결하기 위해 도와준다.</td>
<td style="text-align: right;">-0.114</td>
<td style="text-align: right;">0.775</td>
<td style="text-align: right;">0.022</td>
<td style="text-align: right;">-0.099</td>
</tr>
<tr class="even">
<td style="text-align: left;">a21</td>
<td style="text-align: left;">21. 고객 응대 과정에서 발생한 문제를 해결하고 도와주는 직장 내의 공식적인 제도와 절차가 있다.</td>
<td style="text-align: right;">-0.136</td>
<td style="text-align: right;">0.764</td>
<td style="text-align: right;">-0.002</td>
<td style="text-align: right;">0.132</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a20</td>
<td style="text-align: left;">20. 고객 응대 과정에서 문제가 발생 시 직장에서 적절한 조치가 이루어진다.</td>
<td style="text-align: right;">-0.109</td>
<td style="text-align: right;">0.715</td>
<td style="text-align: right;">0.046</td>
<td style="text-align: right;">0.146</td>
</tr>
<tr class="even">
<td style="text-align: left;">a22</td>
<td style="text-align: left;">22. 직장은 고객 응대 과정에서 입은 마음의 상처를 위로받게 해준다.</td>
<td style="text-align: right;">-0.196</td>
<td style="text-align: right;">0.706</td>
<td style="text-align: right;">-0.174</td>
<td style="text-align: right;">-0.089</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a25</td>
<td style="text-align: left;">25. 직장 내에 고객 응대에 관한 행동지침이나 매뉴얼(설명서, 안내서)이 마련되어 있다.</td>
<td style="text-align: right;">-0.069</td>
<td style="text-align: right;">0.609</td>
<td style="text-align: right;">0.101</td>
<td style="text-align: right;">0.129</td>
</tr>
<tr class="even">
<td style="text-align: left;">a24</td>
<td style="text-align: left;">24. 동료는 고객 응대 과정에서 발생한 문제를 해결하기 위해 도와준다.</td>
<td style="text-align: right;">0.069</td>
<td style="text-align: right;">0.581</td>
<td style="text-align: right;">0.079</td>
<td style="text-align: right;">-0.137</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a26</td>
<td style="text-align: left;">26. 고객의 요구를 해결해 줄 수 있는 권한이나 자율성이 나에게 주어져 있다.</td>
<td style="text-align: right;">-0.055</td>
<td style="text-align: right;">0.575</td>
<td style="text-align: right;">-0.159</td>
<td style="text-align: right;">-0.191</td>
</tr>
<tr class="even">
<td style="text-align: left;">a3</td>
<td style="text-align: left;">3. 업무상 고객을 대하는 과정에서 나의 솔직한 감정을 숨긴다.</td>
<td style="text-align: right;">0.209</td>
<td style="text-align: right;">-0.031</td>
<td style="text-align: right;">0.769</td>
<td style="text-align: right;">0.075</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a1</td>
<td style="text-align: left;">1. 고객에게 부정적인 감정을 표현하지 않으려고 의식적으로 노력한다.</td>
<td style="text-align: right;">0.146</td>
<td style="text-align: right;">0.060</td>
<td style="text-align: right;">0.729</td>
<td style="text-align: right;">0.069</td>
</tr>
<tr class="even">
<td style="text-align: left;">a2</td>
<td style="text-align: left;">2. 고객을 대할 때 회사의 요구대로 감정 표현을 할 수밖에 없다.</td>
<td style="text-align: right;">0.225</td>
<td style="text-align: right;">-0.017</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">0.207</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a4</td>
<td style="text-align: left;">4. 일상적인 업무수행을 위해서는 감정을 조절하려는 노력이 필요하다.</td>
<td style="text-align: right;">0.235</td>
<td style="text-align: right;">0.051</td>
<td style="text-align: right;">0.664</td>
<td style="text-align: right;">-0.017</td>
</tr>
<tr class="even">
<td style="text-align: left;">a5</td>
<td style="text-align: left;">5. 고객을 대할 때 느끼는 나의 감정과 내가 실제 표현하는 감정은 다르다.</td>
<td style="text-align: right;">0.426</td>
<td style="text-align: right;">-0.056</td>
<td style="text-align: right;">0.574</td>
<td style="text-align: right;">0.054</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a16</td>
<td style="text-align: left;">16. 직장이 요구하는 대로 고객에게 잘 응대하는지 감시를 당한다(CC TV 등).</td>
<td style="text-align: right;">0.307</td>
<td style="text-align: right;">-0.136</td>
<td style="text-align: right;">0.084</td>
<td style="text-align: right;">0.707</td>
</tr>
<tr class="even">
<td style="text-align: left;">a19</td>
<td style="text-align: left;">19. 직원들을 보호하기 위하여 고객들의 부당한 행위를 직장에서 모니터링(관찰, 녹음, 확인 등) 하고 있다.</td>
<td style="text-align: right;">0.076</td>
<td style="text-align: right;">0.301</td>
<td style="text-align: right;">-0.005</td>
<td style="text-align: right;">0.666</td>
</tr>
<tr class="odd">
<td style="text-align: left;">a17</td>
<td style="text-align: left;">17. 고객의 평가가 업무성과평가나 인사고과에 영향을 준다.</td>
<td style="text-align: right;">0.338</td>
<td style="text-align: right;">-0.034</td>
<td style="text-align: right;">0.211</td>
<td style="text-align: right;">0.656</td>
</tr>
<tr class="even">
<td style="text-align: left;">a18</td>
<td style="text-align: left;">18. 고객 응대에 문제가 발생했을 때, 나의 잘못이 아닌데도 직장으로부터 부당한 처우를 받는다.</td>
<td style="text-align: right;">0.406</td>
<td style="text-align: right;">-0.268</td>
<td style="text-align: right;">0.131</td>
<td style="text-align: right;">0.588</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(psych)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>fit5 <span class="ot">&lt;-</span> <span class="fu">principal</span>(em, <span class="at">nfactors=</span><span class="dv">5</span>, <span class="at">rotate=</span><span class="st">"varimax"</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="co">#print(fit5, digits = 3, sort = TRUE)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>로딩값 0.4이상인 것을 하나의 동일한 요인으로 구분해보고, 우리의 생각과 비슷한지 관찰해 보자.</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-striped table-sm small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">Q</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">ques</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RC1</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RC2</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RC3</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RC4</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">RC5</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left; color: black !important; background-color: white !important;">a14</td>
<td style="text-align: left; color: black !important; background-color: white !important;">14. 고객을 대하는 과정에서 마음의 상처를 받는다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.833</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.080</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.160</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.142</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.129</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: white !important;">a13</td>
<td style="text-align: left; color: black !important; background-color: white !important;">13. 퇴근 후에도 고객을 응대할 때 힘들었던 감정이 남아 있다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.793</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.086</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.126</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.122</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.130</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: black !important; background-color: white !important;">a11</td>
<td style="text-align: left; color: black !important; background-color: white !important;">11. 고객에게 감정을 숨기고 표현하지 못할 때 나는 감정이 상한다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.758</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.089</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.222</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.147</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.134</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: white !important;">a12</td>
<td style="text-align: left; color: black !important; background-color: white !important;">12. 고객을 응대할 때 나의 감정이 상품처럼 느껴진다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.743</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.121</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.192</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.207</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.124</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: black !important; background-color: white !important;">a10</td>
<td style="text-align: left; color: black !important; background-color: white !important;">10. 고객을 응대할 때 자존심이 상한다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.714</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.153</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.187</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.211</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.225</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: white !important;">a15</td>
<td style="text-align: left; color: black !important; background-color: white !important;">15. 몸이 피곤해도 고객들에게 최선을 다해야 하므로 감정적으로 힘들다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.693</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.072</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.268</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.180</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.207</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: black !important; background-color: white !important;">a9</td>
<td style="text-align: left; color: black !important; background-color: white !important;">9. 직장은 나의 상황보다는 고객의 입장만을 고려하도록 강요한다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.418</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.196</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.265</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.354</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.376</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important; background-color: white !important;">a23</td>
<td style="text-align: left; color: red !important; background-color: white !important;">23. 상사는 고객 응대 과정에서 발생한 문제를 해결하기 위해 도와준다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.101</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.775</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.026</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.108</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.039</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important; background-color: white !important;">a21</td>
<td style="text-align: left; color: red !important; background-color: white !important;">21. 고객 응대 과정에서 발생한 문제를 해결하고 도와주는 직장 내의 공식적인 제도와 절차가 있다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.095</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.763</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.021</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.116</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.130</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important; background-color: white !important;">a20</td>
<td style="text-align: left; color: red !important; background-color: white !important;">20. 고객 응대 과정에서 문제가 발생 시 직장에서 적절한 조치가 이루어진다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.022</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.708</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.100</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.121</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.234</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important; background-color: white !important;">a22</td>
<td style="text-align: left; color: red !important; background-color: white !important;">22. 직장은 고객 응대 과정에서 입은 마음의 상처를 위로받게 해준다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.112</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.701</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.136</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.112</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.223</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important; background-color: white !important;">a25</td>
<td style="text-align: left; color: red !important; background-color: white !important;">25. 직장 내에 고객 응대에 관한 행동지침이나 매뉴얼(설명서, 안내서)이 마련되어 있다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.128</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.617</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.067</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.135</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.119</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important; background-color: white !important;">a24</td>
<td style="text-align: left; color: red !important; background-color: white !important;">24. 동료는 고객 응대 과정에서 발생한 문제를 해결하기 위해 도와준다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.025</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.590</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.026</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.121</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.252</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important; background-color: white !important;">a26</td>
<td style="text-align: left; color: red !important; background-color: white !important;">26. 고객의 요구를 해결해 줄 수 있는 권한이나 자율성이 나에게 주어져 있다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.058</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.578</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.169</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.192</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.020</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: black !important; background-color: white !important;">a3</td>
<td style="text-align: left; color: black !important; background-color: white !important;">3. 업무상 고객을 대하는 과정에서 나의 솔직한 감정을 숨긴다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.198</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.043</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.797</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.073</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.059</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: white !important;">a1</td>
<td style="text-align: left; color: black !important; background-color: white !important;">1. 고객에게 부정적인 감정을 표현하지 않으려고 의식적으로 노력한다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.120</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.050</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.743</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.068</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.082</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: black !important; background-color: white !important;">a2</td>
<td style="text-align: left; color: black !important; background-color: white !important;">2. 고객을 대할 때 회사의 요구대로 감정 표현을 할 수밖에 없다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.194</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.026</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.678</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.210</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.099</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: white !important;">a4</td>
<td style="text-align: left; color: black !important; background-color: white !important;">4. 일상적인 업무수행을 위해서는 감정을 조절하려는 노력이 필요하다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.168</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.046</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.654</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.006</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.205</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: black !important; background-color: white !important;">a5</td>
<td style="text-align: left; color: black !important; background-color: white !important;">5. 고객을 대할 때 느끼는 나의 감정과 내가 실제 표현하는 감정은 다르다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.371</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.064</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.579</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.068</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.210</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important; background-color: white !important;">a16</td>
<td style="text-align: left; color: red !important; background-color: white !important;">16. 직장이 요구하는 대로 고객에게 잘 응대하는지 감시를 당한다(CC TV 등).</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.252</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.130</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.077</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.721</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.126</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important; background-color: white !important;">a17</td>
<td style="text-align: left; color: red !important; background-color: white !important;">17. 고객의 평가가 업무성과평가나 인사고과에 영향을 준다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.232</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.025</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.176</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.679</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.257</td>
</tr>
<tr class="even">
<td style="text-align: left; color: red !important; background-color: white !important;">a19</td>
<td style="text-align: left; color: red !important; background-color: white !important;">19. 직원들을 보호하기 위하여 고객들의 부당한 행위를 직장에서 모니터링(관찰, 녹음, 확인 등) 하고 있다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.121</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.300</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.036</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.654</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.149</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: red !important; background-color: white !important;">a18</td>
<td style="text-align: left; color: red !important; background-color: white !important;">18. 고객 응대에 문제가 발생했을 때, 나의 잘못이 아닌데도 직장으로부터 부당한 처우를 받는다.</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.318</td>
<td style="text-align: right; color: red !important; background-color: white !important;">-0.261</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.108</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.611</td>
<td style="text-align: right; color: red !important; background-color: white !important;">0.231</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: white !important;">a7</td>
<td style="text-align: left; color: black !important; background-color: white !important;">7. 나의 능력이나 권한 밖의 일을 요구하는 고객을 상대해야 한다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.384</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.071</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.254</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.161</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.705</td>
</tr>
<tr class="odd">
<td style="text-align: left; color: black !important; background-color: white !important;">a6</td>
<td style="text-align: left; color: black !important; background-color: white !important;">6. 공격적이거나 까다로운 고객을 상대해야 한다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.352</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.010</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.317</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.110</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.693</td>
</tr>
<tr class="even">
<td style="text-align: left; color: black !important; background-color: white !important;">a8</td>
<td style="text-align: left; color: black !important; background-color: white !important;">8. 고객의 부당하거나 막무가내의 요구로 업무 수행의 어려움이 있다.</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.459</td>
<td style="text-align: right; color: black !important; background-color: white !important;">-0.071</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.244</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.215</td>
<td style="text-align: right; color: black !important; background-color: white !important;">0.641</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
</section>
<section id="요인-개수-정하기-신뢰도-측면" class="level2" data-number="2.3">
<h2 data-number="2.3" class="anchored" data-anchor-id="요인-개수-정하기-신뢰도-측면"><span class="header-section-number">2.3</span> 요인 개수 정하기: 신뢰도 측면</h2>
<section id="신뢰도-값-cronbach-alpha" class="level3" data-number="2.3.1">
<h3 data-number="2.3.1" class="anchored" data-anchor-id="신뢰도-값-cronbach-alpha"><span class="header-section-number">2.3.1</span> 신뢰도 값 (Cronbach alpha)</h3>
<p>전체의 신뢰도 값은 `Cronbach alpha1를 구해보면</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>total_alpha <span class="ot">&lt;-</span> em <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">alpha</span>(<span class="at">check.keys =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="fu">summary</span>() <span class="sc">%&gt;%</span> <span class="fu">tibble</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Reliability analysis   
 raw_alpha std.alpha G6(smc) average_r S/N    ase mean   sd median_r
       0.9       0.9    0.93      0.26 9.2 0.0031  2.8 0.47     0.26</code></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>total_alpha</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 0 × 0</code></pre>
</div>
</div>
<p><code>0.9</code>로 매우 높다. 설문의 내적 신뢰도가 매우 높아 잘 구성된 설문으로 판단된다. 이와 마찬가지로, 각 5개 요인별 신뢰도를 구해서 비교해 보면 다음과 같다.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>[[1]]
 raw_alpha std.alpha   G6(smc) average_r      S/N         ase     mean
 0.8999274 0.9018293 0.9295131 0.2610769 9.186341 0.003141005 2.827998
        sd  median_r
 0.4735525 0.2614902

[[2]]
 raw_alpha std.alpha   G6(smc) average_r      S/N         ase    mean       sd
 0.9055774 0.9057706 0.8991453 0.5786279 9.612397 0.003203386 2.89193 0.723457
  median_r
 0.5848336

[[3]]
 raw_alpha std.alpha   G6(smc) average_r      S/N         ase     mean
 0.8131309 0.8126849 0.8038001 0.3826398 4.338599 0.006332137 2.562161
        sd  median_r
 0.6179742 0.3435262

[[4]]
 raw_alpha std.alpha   G6(smc) average_r      S/N        ase     mean        sd
 0.7944449 0.7975002 0.7656453  0.440608 3.938276 0.00720726 3.381537 0.5348358
  median_r
 0.4384749

[[5]]
 raw_alpha std.alpha   G6(smc) average_r      S/N        ase     mean        sd
  0.715695 0.7199323 0.6839464 0.3912243 2.570565 0.01046568 2.481662 0.7527246
  median_r
 0.4126389

[[6]]
 raw_alpha std.alpha   G6(smc) average_r      S/N        ase    mean        sd
 0.8698312 0.8699297 0.8189101 0.6903434 6.688153 0.00501236 3.12841 0.7631397
  median_r
 0.6931711</code></pre>
</div>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">raw_alpha</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">std.alpha</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Total alpha</td>
<td style="text-align: right;">0.900</td>
<td style="text-align: right;">0.902</td>
</tr>
<tr class="even">
<td style="text-align: left;">RC1 alpha</td>
<td style="text-align: right;">0.906</td>
<td style="text-align: right;">0.906</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RC2 alpha</td>
<td style="text-align: right;">0.813</td>
<td style="text-align: right;">0.813</td>
</tr>
<tr class="even">
<td style="text-align: left;">RC3 alpha</td>
<td style="text-align: right;">0.794</td>
<td style="text-align: right;">0.798</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RC4 alpha</td>
<td style="text-align: right;">0.716</td>
<td style="text-align: right;">0.720</td>
</tr>
<tr class="even">
<td style="text-align: left;">RC5 alpha</td>
<td style="text-align: right;">0.870</td>
<td style="text-align: right;">0.870</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>이후 연구잘들이 이렇게 모인 것이 의미적으로도 타당하고, 수치적으로도 타당하면 설문지로서 내적 신뢰도를 확보했다고 볼수 있다.</p>
</section>
</section>
<section id="요인값-활용하기" class="level2" data-number="2.4">
<h2 data-number="2.4" class="anchored" data-anchor-id="요인값-활용하기"><span class="header-section-number">2.4</span> 요인값 활용하기</h2>
<section id="요인값-데이터화" class="level3" data-number="2.4.1">
<h3 data-number="2.4.1" class="anchored" data-anchor-id="요인값-데이터화"><span class="header-section-number">2.4.1</span> 요인값 데이터화</h3>
<p>요인값 (score)는 <code>fit</code>모델의 <code>scores</code>라는 list에 데이터 형식으로 저장되어 있다. 이를 <code>gg</code> 파일에 횡병합한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(gg, fit5<span class="sc">$</span>scores)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(gg1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  no_1 no_2 gender age education marriage                       job job_code
1    3    1      2  34         3        1                    회사원        9
2    3    2      2  27         3        1                 보상,상담        6
3    3    3      2  37         3        2                    사무직        9
4    3    4      2  40         2        2                    사무직        9
5    3    5      2  44         1        2              가입지원요원        6
6    3    6      2  38         3        2 근로복지공단 가입지원요원       12
  job_code5 day_hour year month type shift working_hour holiday holiday_hour a1
1         4        8   12     0    1     2           40       2           NA  4
2         1        9    2     0    1     2           40       2           NA  3
3         4        9   10     0    1     2           40       2           NA  4
4         4        8   18     0    1     2           35       2           NA  4
5         1        9    1     2    2     2           40       2           NA  4
6         4        9    1     2    2     2           40       2           NA  3
  a2 a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 a13 a14 a15 a16 a17 a18 a19 a20 a21 a22
1  4  4  4  4  4  3  4  3   3   4   3   4   4   4   3   2   1   2   3   3   2
2  3  4  4  4  4  4  4  4   3   3   2   3   4   4   3   3   2   3   2   1   1
3  4  4  4  4  4  3  3  3   3   4   3   3   3   3   2   3   4   2   1   3   2
4  4  4  4  4  4  3  4  4   3   4   3   4   4   4   3   2   2   4   3   2   2
5  1  3  4  3  4  2  2  3   3   3   3   3   3   2   1   1   1   1   1   1   2
6  3  4  4  3  3  3  3  3   1   3   3   1   3   1   1   1   1   1   3   1   1
  a23 a24 a25 a26 d1 d2 d3 d4 d5 d6 d7 d8 d9 e1 e2 e3 e4 e5 f1 f2 f3 g1 g1_day
1   3   3   2   2  3  1  1  1  1  1  1  1  0  4  4  4  4  4  6  5  5  1     NA
2   1   3   1   2  1  1  1  1  2  0  0  0  0  4  4  4  4  4  4  8  9  1     NA
3   3   3   3   2  2  2  1  1  1  1  1  0  0  3  3  3  3  4  5 10  7  2     NA
4   2   4   3   4  1  1  0  1  1  0  0  0  0  4  4  3  4  4  9 10 10  2     NA
5   2   2   1   1  1  1  1  1  0  1  0  0  1  2  2  2  2  3  5  8  6  1     NA
6   2   3   3   1  1  1  1  1  2  0  0  0  0  3  3  3  2  4  6  8  7  1     NA
  g1_1 g2 g2_day g2_1 g3 g3_day g4 g5 g6 g6_1 age_group workhour new_month
1   NA  1     NA   NA  2     NA  2  4  1   NA         2        2 0.0000000
2   NA  1     NA   NA  2     NA  2  3  1   NA         1        2 0.0000000
3    1  2     NA    1  2     NA  1  4  1   NA         2        2 0.0000000
4    1  1     NA   NA  2     NA  2  3  1   NA         3        1 0.0000000
5   NA  1     NA   NA  1     NA  2  2  1   NA         3        2 0.1666667
6   NA  1     NA   NA  1     NA  2  3  1   NA         2        2 0.1666667
   new_year         RC1        RC2         RC3        RC4         RC5
1 12.000000  1.41391758  0.2697825  1.06493093 -1.2119756 -0.50045351
2  2.000000  0.29155505 -1.3583095  0.06978903 -0.1336951  1.00758714
3 10.000000  0.08621152 -0.2683814  1.02177770 -0.1138303  0.23768768
4 18.000000  1.30583594  0.6955646  0.68449865 -0.3480365  0.07637027
5  1.166667  0.49545461 -1.7340666 -0.31311884 -2.4465539 -0.62733016
6  1.166667 -1.13527184 -1.0465152  0.72011247 -1.6794867  0.17207067</code></pre>
</div>
</div>
</section>
<section id="우울증-점수-phq-9" class="level3" data-number="2.4.2">
<h3 data-number="2.4.2" class="anchored" data-anchor-id="우울증-점수-phq-9"><span class="header-section-number">2.4.2</span> 우울증 점수 (PHQ-9)</h3>
<p>PHQ-9 설문지가 d1~d9까지있고, 우선 단순 합으로 계산한다(9번 문항의 별도 가중치 고려하지 않음).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="sc">%&gt;%</span>  <span class="fu">select</span>(<span class="fu">grep</span>(<span class="st">'^d</span><span class="sc">\\</span><span class="st">d'</span>, <span class="fu">colnames</span>(.))) <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>         <span class="fu">rowSums</span>(.) <span class="ot">-&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>gg1<span class="sc">$</span>dep_score </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>5개의 factor score와 PHQ-9의 총합의 상관관계를 분석해 본다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="sc">%&gt;%</span> <span class="fu">select</span>(no_2, dep_score, <span class="fu">grep</span>(<span class="st">'RC'</span>, <span class="fu">colnames</span>(.))) <span class="sc">%&gt;%</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>        dplyr<span class="sc">::</span><span class="fu">rename</span>(<span class="at">ID =</span> no_2) <span class="sc">%&gt;%</span> <span class="fu">drop_na</span>() <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>        <span class="fu">gather</span> (<span class="at">key =</span> factor, <span class="at">value=</span>score, RC1<span class="sc">:</span>RC5) <span class="sc">%&gt;%</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>        <span class="fu">filter</span> (score <span class="sc">&lt;</span> <span class="fl">2.5</span> <span class="sc">&amp;</span> score <span class="sc">&gt;-</span><span class="fl">2.5</span>) <span class="sc">%&gt;%</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">ggplot</span> (<span class="fu">aes</span>(<span class="at">x =</span> score, <span class="at">y =</span>dep_score, <span class="at">group=</span>factor)) <span class="sc">+</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span> (<span class="fu">aes</span>(<span class="at">color =</span> factor), <span class="at">alpha=</span><span class="fl">0.05</span>)<span class="sc">+</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">color =</span> factor), <span class="at">method=</span><span class="st">'lm'</span>, <span class="at">se=</span>F) <span class="sc">+</span></span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span> (factor <span class="sc">~</span>.) <span class="sc">+</span></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_minimal</span> ()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="210_jobstress2_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="요인별-사용-방법" class="level3" data-number="2.4.3">
<h3 data-number="2.4.3" class="anchored" data-anchor-id="요인별-사용-방법"><span class="header-section-number">2.4.3</span> 요인별 사용 방법</h3>
<p>R1은 양의 상관관계, RC2는 음의 상관관계, RC3는 특이 사항 없고, RC4, RC5는 양의 상관관계가 있다. 각 항목별로 기울기 등 관련성의 특성이 다르므로 각각 사용하는 것이 좋겠다. 모두 합산하기 보다는 각 요인별로 설문지의 값을 더하고 이것을 이용하자는 것이다. R1은 주로 감정의 소진, R2는 감정노동 보호체계 이런 식으로 나타낼 수 있다. 연구자가 의도에 맞게 명명을 하면 된다.</p>
</section>
<section id="과제-소진-증후군과-감정노동" class="level3" data-number="2.4.4">
<h3 data-number="2.4.4" class="anchored" data-anchor-id="과제-소진-증후군과-감정노동"><span class="header-section-number">2.4.4</span> 과제: 소진 증후군과 감정노동</h3>
<ol type="1">
<li><p>소진 증후군의 설문문항 5개를 더하여 총점인 <code>burn_out_score</code>라는 변수를 구하시오.</p></li>
<li><p>burn_out_score 와 각 factor 요인간의 선형 상관관계를 그림으로 그리시오.</p></li>
<li><p>regression coefficient의 절대값이 가장 큰 것 요인은?</p></li>
<li><p>각 factor 요인을 따로 사용하는 것이 좋을지 같이 합산해서 같이 사용하는 것이 좋을지 의견을 내시요.</p></li>
</ol>
</section>
</section>
<section id="mediation" class="level2" data-number="2.5">
<h2 data-number="2.5" class="anchored" data-anchor-id="mediation"><span class="header-section-number">2.5</span> Indirect effect</h2>
<p>본 강의에서는 2014년 장세진 등이 연구한 한국형 감정노동 설문지의 연구 계발 중 감정노동 설문지 하부 구조 구성에 대한 내용이다. 감정근로자를 대상으로한 질적 면담을 통해 총 26개 질적 항목이 도출되었다. 이를 조사 문항으로 변경하였고, 2014년 약 2000명의 고객 응대 근로자를 조사하였다. 이 중 변수를 축소할 수 있으지, 불필요한 변수가 있는지, 변수 사이에 일정한 특성이 있어 하부 구조를 만들수 있는지 여부를 판단하는 것이 실습 목표이다. 요인분석 이전까지의 Data step은 저번 강의를 참조하고, 이번 강의에서는 Data step에서 필요한 부분만 시행하겠다.</p>
<p>필요한 library를 불러오자</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(diagram)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(mediation)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="st">"'path B'"</span>, <span class="dv">0</span>,</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>          <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>          <span class="st">"'path C'"</span>, <span class="st">"'path A'"</span>, <span class="dv">0</span>)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>M<span class="ot">&lt;-</span> <span class="fu">matrix</span> (<span class="at">nrow=</span><span class="dv">3</span>, <span class="at">ncol=</span><span class="dv">3</span>, <span class="at">byrow =</span> <span class="cn">TRUE</span>, <span class="at">data=</span>data)</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>plot<span class="ot">&lt;-</span> <span class="fu">plotmat</span> (M, <span class="at">pos=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), </span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>                <span class="at">name=</span> <span class="fu">c</span>( <span class="st">"burnout"</span>,<span class="st">"Engaging </span><span class="sc">\n</span><span class="st">out of control"</span>, <span class="st">"Depression"</span>), </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>                <span class="at">box.type =</span> <span class="st">"rect"</span>, <span class="at">box.size =</span> <span class="fl">0.12</span>, <span class="at">box.prop=</span><span class="fl">0.5</span>,  <span class="at">curve=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="210_jobstress2_files/figure-html/indirect path-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="첫번째-testing-total-effect" class="level4" data-number="2.5.0.1">
<h4 data-number="2.5.0.1" class="anchored" data-anchor-id="첫번째-testing-total-effect"><span class="header-section-number">2.5.0.1</span> 첫번째 testing total effect</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>gg1 <span class="ot">&lt;-</span>gg1 <span class="sc">%&gt;%</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">burnout =</span> e1<span class="sc">+</span>e2<span class="sc">+</span>e3<span class="sc">+</span>e4<span class="sc">+</span>e5) <span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(burnout), <span class="sc">!</span><span class="fu">is.na</span>(dep_score), <span class="sc">!</span><span class="fu">is.na</span>(RC3))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>path A 의 회귀 분석 수행하고</p>
<p><span class="math display">\[ Depression = b_{0} + b_{1}RC1 + e \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fit.T <span class="ot">&lt;-</span> </span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>  gg1 <span class="sc">%&gt;%</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span> (<span class="at">data=</span>., </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>      dep_score <span class="sc">~</span> RC5)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.T)<span class="sc">$</span>coeff <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">7.597578</td>
<td style="text-align: right;">0.1291604</td>
<td style="text-align: right;">58.82283</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">RC5</td>
<td style="text-align: right;">0.877671</td>
<td style="text-align: right;">0.1307459</td>
<td style="text-align: right;">6.71280</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="두번째-mediator-on-x" class="level4" data-number="2.5.0.2">
<h4 data-number="2.5.0.2" class="anchored" data-anchor-id="두번째-mediator-on-x"><span class="header-section-number">2.5.0.2</span> 두번째 (mediator on X)</h4>
<p>두번째는 어려운 고객을 상대하는 것인 매개변수로 여겨지는 소진을 어떻게 설명하는지 분석하는 것이다.</p>
<p><span class="math display">\[ Burnout = b_{0} + b_{2}RC1 + e \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>fit.M <span class="ot">&lt;-</span> </span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  gg1 <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span> (<span class="at">data=</span>., </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>      burnout <span class="sc">~</span> RC5)</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.M)<span class="sc">$</span>coeff <span class="sc">%&gt;%</span> <span class="fu">kable</span>()  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">14.2992138</td>
<td style="text-align: right;">0.0927035</td>
<td style="text-align: right;">154.246717</td>
<td style="text-align: right;">0</td>
</tr>
<tr class="even">
<td style="text-align: left;">RC5</td>
<td style="text-align: right;">0.7289394</td>
<td style="text-align: right;">0.0938415</td>
<td style="text-align: right;">7.767772</td>
<td style="text-align: right;">0</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="세번째-y-on-x-and-mediator" class="level4" data-number="2.5.0.3">
<h4 data-number="2.5.0.3" class="anchored" data-anchor-id="세번째-y-on-x-and-mediator"><span class="header-section-number">2.5.0.3</span> 세번째 (Y on X and Mediator)</h4>
<p><span class="math display">\[ Depression = b_{0} + b_{3} Burnout +b_{4} RC1 + e \]</span></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>fit.Y <span class="ot">&lt;-</span> </span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  gg1 <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">lm</span> (<span class="at">data=</span>., </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>      dep_score <span class="sc">~</span> burnout <span class="sc">+</span> RC5)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit.Y)<span class="sc">$</span>coeff <span class="sc">%&gt;%</span> <span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th"></th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Estimate</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Std. Error</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">t value</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Pr(&gt;|t|)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">(Intercept)</td>
<td style="text-align: right;">-5.2686545</td>
<td style="text-align: right;">0.3585568</td>
<td style="text-align: right;">-14.694057</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">burnout</td>
<td style="text-align: right;">0.8997860</td>
<td style="text-align: right;">0.0241078</td>
<td style="text-align: right;">37.323484</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="odd">
<td style="text-align: left;">RC5</td>
<td style="text-align: right;">0.2217815</td>
<td style="text-align: right;">0.1013842</td>
<td style="text-align: right;">2.187534</td>
<td style="text-align: right;">0.0288221</td>
</tr>
</tbody>
</table>


</div>
</div>
</section>
<section id="causal-mediation-analysis" class="level4" data-number="2.5.0.4">
<h4 data-number="2.5.0.4" class="anchored" data-anchor-id="causal-mediation-analysis"><span class="header-section-number">2.5.0.4</span> Causal Mediation analysis</h4>
<p>mediation페키지의 mediate는 ACE, average causal mediaton effects와 ADE, a direct effect 를 계산하고 그 값이 0이 아닌지의 귀무가설을 bootstrapping 방법으로 계산해 준다. 본 실습에서는 상기 방법에 대한 자세한 내용은 생략하며, 실습을 중심으로 진행한다.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>exp <span class="ot">&lt;-</span> </span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mediate</span>(fit.M, </span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>          fit.Y, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>          <span class="at">treat    =</span>   <span class="st">'RC5'</span>, <span class="co"># 독립변수</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>          <span class="at">mediator =</span>   <span class="st">'burnout'</span>, <span class="co"># 매개변수</span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">boot     =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">sims     =</span> <span class="dv">500</span>)</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Causal Mediation Analysis 

Nonparametric Bootstrap Confidence Intervals with the Percentile Method

               Estimate 95% CI Lower 95% CI Upper p-value    
ACME             0.6559       0.4659         0.84  &lt;2e-16 ***
ADE              0.2218       0.0149         0.39    0.02 *  
Total Effect     0.8777       0.6245         1.12  &lt;2e-16 ***
Prop. Mediated   0.7473       0.6014         0.98  &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Sample Size Used: 1950 


Simulations: 500 </code></pre>
</div>
</div>
<p>앞서 분석한 결과에서 b1 = 0.8776, p &lt;0.001, b2 = 0.7289, p &lt;0.001, b3 = 0.90, p &lt;0.001, b4 = 0.22, p = 0.03를 기억하자. 지금 분석한 결과에서 Total Effect 0.8777 은 b1으로 어려운 고객 상대가 우울에 미치는 회귀계수이다. ADE 0.22는 b4로 3번째 모델에서 소진과 어려운 고객상대가 모형에 동시에 존재할 때 우울에 대한 감정노동 요인의 회기계수이다. 이것을 direct effect로 부른다. Total Effect에서 direct effect를 뺀 값은 0.66이고 이 값이 ACME가 된다. 해석에서 가장 중요한 부분은 b1에서 b4를 뺀 부분이 ACME라는 것이다. 또한 0.88에서 0.22로 0.66 만큼 줄었고 그 값에 대한 p value 가 0.05보다 작다는 것이다. 즉 번아웃의 매개효과의 크기가 크고 통계적으로 유의한 수준으로 존재한다.</p>
</section>
<section id="소결" class="level4" data-number="2.5.0.5">
<h4 data-number="2.5.0.5" class="anchored" data-anchor-id="소결"><span class="header-section-number">2.5.0.5</span> 소결</h4>
<p>설문지를 개발하여 나타나는 요인들을 사용할 때 주의할 점 중 하나가 매개효과에 관한 것이다. 우리가 예상했던 설문지안에는 여러 요소가 들어 있고 어떤 요소는 스트레스의 원인/반응/매개 중에 하나에 특화된 것이 있다. 예를 들어 원인은 가끔 조직적/사회적인 것을 조사하며, 반응은 매우 생물학적인 것을 대변한다. 따라서 원인과 반응간에 매개변수가 필요할 수 가 있다. 상기 매개변수를 찾는 다면, 스트레스 원인이 건강영향을 일으키는데 중재할 수 있는 지식을 발굴해 낼 수 있다.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./210_jobstress1.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">직무스트레스란</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>